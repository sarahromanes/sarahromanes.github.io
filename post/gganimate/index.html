<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.40.2" />
  <meta name="author" content="Sarah Romanes">

  
  
  
  
    
      
    
  
  <meta name="description" content="Have you ever had one of those moments whilst teaching where the content blows your mind? Today, whilst teaching MATH1005 at the University of Sydney, that exact thing happened to me.
This weeks content was focused on teaching the students the introductions to linear modelling. A very strightforward topic, and one ususally understood well by first years. However, a twist in our teaching style left me with such an appreciation for the simpler explanations in statistics.">

  
  <link rel="alternate" hreflang="en-us" href="/post/gganimate/">

  


  

  
  
  <meta name="theme-color" content="#0095eb">
  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Playfair&#43;Display:400,700%7cFauna&#43;One">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Sarah Romanes">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Sarah Romanes">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/gganimate/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@sarah_romanes">
  <meta property="twitter:creator" content="@sarah_romanes">
  
  <meta property="og:site_name" content="Sarah Romanes">
  <meta property="og:url" content="/post/gganimate/">
  <meta property="og:title" content="My first gganimate - exploring concepts from first year linear modelling! | Sarah Romanes">
  <meta property="og:description" content="Have you ever had one of those moments whilst teaching where the content blows your mind? Today, whilst teaching MATH1005 at the University of Sydney, that exact thing happened to me.
This weeks content was focused on teaching the students the introductions to linear modelling. A very strightforward topic, and one ususally understood well by first years. However, a twist in our teaching style left me with such an appreciation for the simpler explanations in statistics.">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-08-28T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-08-28T00:00:00&#43;00:00">
  

  
  

  <title>My first gganimate - exploring concepts from first year linear modelling! | Sarah Romanes</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Sarah Romanes</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#packages">
            
            <span>Packages</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">My first gganimate - exploring concepts from first year linear modelling!</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-08-28 00:00:00 &#43;0000 UTC" itemprop="datePublished dateModified">
      Aug 28, 2018
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Sarah Romanes">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 min read
  </span>
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/data-viz/">data-viz</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=My%20first%20gganimate%20-%20exploring%20concepts%20from%20first%20year%20linear%20modelling%21&amp;url=%2fpost%2fgganimate%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fgganimate%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fgganimate%2f&amp;title=My%20first%20gganimate%20-%20exploring%20concepts%20from%20first%20year%20linear%20modelling%21"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fgganimate%2f&amp;title=My%20first%20gganimate%20-%20exploring%20concepts%20from%20first%20year%20linear%20modelling%21"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=My%20first%20gganimate%20-%20exploring%20concepts%20from%20first%20year%20linear%20modelling%21&amp;body=%2fpost%2fgganimate%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      <p>Have you ever had one of those moments whilst teaching where the content blows your mind? Today, whilst teaching MATH1005 at the University of Sydney, that exact thing happened to me.</p>
<p>This weeks content was focused on teaching the students the introductions to linear modelling. A very strightforward topic, and one ususally understood well by first years. However, a twist in our teaching style left me with such an appreciation for the simpler explanations in statistics.</p>
<div id="linear-modelling---through-calculus" class="section level2">
<h2>Linear modelling - through calculus</h2>
<p>Throwing back to 6 years ago when I was a first year, and even back to a year ago when I first taught this course, linear regression was taught in a very standard way.</p>
<p>If I have some continuous bivariate data, and the relationship between the two variables looks linear upon inspection, how can one fit a line which is ‘optimal’? The standard way of answering this question is to treat the problem as a mathematical one, using <strong>calculus</strong> to find the slope and intercept that minimise the sum of squares between the fitted line and the observed responses. See <a href="https://math.stackexchange.com/a/63301"><strong>here</strong></a> for one of the many examples of this on StackExchange.</p>
<p>This usually is very easy to understand by first years, and seemed the simplest possible way of explanation I could concieve. But then came along another explanation…</p>
</div>
<div id="the-sd-line" class="section level2">
<h2>The SD Line</h2>
<p>Imagine you are trying to find the best line to fit the data, without any knowledge of calculus. How do you do it? An intuitive way might be to connect the point of averages <span class="math inline">\((\bar{x}, \bar{y})\)</span> to <span class="math inline">\((\bar{x} + \text{SD}_x, \bar{y} + \text{SD}_y)\)</span>. This is described in detail by Freedman, Pisani, and Purves in their book, <a href="https://www.amazon.com/Statistics-Fourth-David-Freedman-ebook/dp/B00SLB5Q72"><strong>Statistics</strong></a>.</p>
<p><img src="/img/sdline.jpg" width="700px" /></p>
<p>Applying this to simulated data, we can visualise the SD line as follows:</p>
<pre class="r"><code>library(ggplot2)
library(dplyr)
library(magrittr)</code></pre>
<pre class="r"><code>gen.y &lt;- function(x, rho) {
  y &lt;- rnorm(length(x)) 
  x.perp &lt;- residuals(lm(y ~ x))
  rho * sd(x.perp) * x + x.perp * sd(x) * sqrt(1 - rho^2)
}</code></pre>
<pre class="r"><code>x &lt;- 1:50
y &lt;- gen.y(x, 0.5)

dat &lt;- data.frame(x=x, y=y)

p.sd &lt;- ggplot(dat %&gt;% mutate(slope.sd=sd(y)/sd(x), 
                        icept.sd= mean(y)- (sd(y)/sd(x))*mean(x)),
                        aes(x, y)) + 
        geom_point() + 
        geom_abline(aes(intercept=icept.sd, slope=slope.sd), col=&quot;red&quot;)+
        geom_vline(xintercept = mean(x)+sd(x))+
        geom_vline(xintercept = mean(x)-sd(x))+
        geom_point(aes(x=mean(x), y=mean(y)), colour=&quot;dodgerblue&quot;, size=5)+
        ggtitle(&quot;SD Line for simulated linear data with r = 0.5&quot;)
        
p.sd</code></pre>
<p><img src="/post/2018-08-28-gganimate_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We have highlighted the point of averages <span class="math inline">\((\bar{x}, \bar{y})\)</span>, and 1 SD on either side of this point. We can see the SD line does a pretty decent job of describing the linear relationship! But alas! Let’s look closely at the extremes. Towards the RHS, the SD line <strong>overestimates</strong> the y response, and towards the LHS, it <strong>underestimates</strong> the values. How can we fix this?</p>
</div>
<div id="a-fix-the-regression" class="section level2">
<h2>A fix? The regression</h2>
<p>The regression line is very similar to the SD line, with a slight change in how it is defined. The regression line is defined as the line connecting <span class="math inline">\((\bar{x}, \bar{y})\)</span> to <span class="math inline">\((\bar{x} + \text{SD}_x, \bar{y} + r\text{SD}_y)\)</span>. See the change? We have incorporated information about how the points <strong>cluster</strong> around the line. As <span class="math inline">\(r\)</span> is in magnitude between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>, the only effect it can possbly have is to <strong>dampen</strong> the gradient! As such, this will push our line down towards the positive extreme, and push the line up towards the negative extreme.</p>
<p>You can show that the equation of this line matches that derived by least squares estimation! Hoorah! How amazing is that???! Or is that only me…</p>
<p>See the effect on our simulated data below, taking advantage of the <code>geom_smooth()</code> function in <code>ggplot2</code>.</p>
<pre class="r"><code>p.r &lt;- p.sd + geom_smooth(method=&#39;lm&#39;,formula=y~x) + ggtitle(&quot;SD and Regression lines for simulated data, r=0.5&quot;)
p.r</code></pre>
<p><img src="/post/2018-08-28-gganimate_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>We can compare the two lines as follows</p>
<p><img src="/img/compare.jpg" width="700px" /></p>
<p>And you can experiment with an app online by Berkeley <a href="https://www.stat.berkeley.edu/~stark/Java/Html/Correlation.htm"><strong>here</strong></a>.</p>
</div>
<div id="gganimate---a-success" class="section level2">
<h2><code>gganimate</code> - a success!</h2>
<p>A cool feature about the regression line is that as <span class="math inline">\(r \rightarrow \pm 1\)</span>, it approaches the SD line! So I thought I would devise my first <code>gganimate</code> plot highlighting this. Feedback regarding the code is much appreciated!</p>
<p>If you don’t have <code>gganimate</code>, you can download from here. Note, this is an updated version <em>not on CRAN</em>.</p>
<pre class="r"><code># install.packages(&#39;devtools&#39;)
devtools::install_github(&#39;thomasp85/gganimate&#39;)</code></pre>
<pre class="r"><code>library(gganimate)</code></pre>
<p>First, I set up the plot without the animation layers. It looks like a bit of a mess with out the frames! The red line is the SD line, and the blue lines are the regression lines.</p>
<pre class="r"><code>x &lt;- 0:50
r &lt;- seq(0, 1, by=0.05)

y.vals &lt;- unlist(purrr::map(r, ~gen.y(x, .)))
x.vals &lt;- rep(x, length(r))
r.vals &lt;- rep(r, each=length(x))


data &lt;- data.frame(x.vals=x.vals, y.vals=y.vals, r.vals=r.vals)
head(data)</code></pre>
<pre><code>##   x.vals     y.vals r.vals
## 1      0   3.378741      0
## 2      1   5.177455      0
## 3      2   6.720238      0
## 4      3  30.914982      0
## 5      4 -22.112538      0
## 6      5  -6.979840      0</code></pre>
<pre class="r"><code>p.set &lt;- ggplot( data %&gt;% group_by(r.vals) %&gt;% mutate(slope.sd=sd(y.vals)/sd(x.vals), 
                                     icept.sd= mean(y.vals)- (sd(y.vals)/sd(x.vals))*mean(x.vals),
                                     slope.r=r.vals*sd(y.vals)/sd(x.vals),
                                     icept.r= mean(y.vals)- (r.vals*sd(y.vals)/sd(x.vals))*mean(x.vals))
             , aes(x.vals, y.vals)) + 
  geom_point() + 
  geom_abline(aes(intercept=icept.sd, slope=slope.sd), col=&quot;red&quot;) +
  geom_abline(aes(intercept=icept.r, slope=slope.r), col=&quot;blue&quot;)


p.set</code></pre>
<p><img src="/post/2018-08-28-gganimate_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Now, we add in the animation layers. And voila! We have an animation!</p>
<pre class="r"><code>p.ani  &lt;- p.set + labs(title = &#39;Correlation Coefficient =  {round(frame_time, 2)}&#39;, x = &#39;x&#39;, y = &#39;y&#39;) +
  transition_time(r.vals) +
  ease_aes(&#39;linear&#39;)

p.ani</code></pre>
<p><img src="/post/2018-08-28-gganimate_files/figure-html/unnamed-chunk-8-1.gif" /><!-- --></p>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="/tags/data-viz/">data-viz</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/post/calendar-plots/">An argument for eating that pizza whilst on vacation - exploring the sugrrants package</a></li>
        
      </ul>
    </div>
    

    

    


  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

